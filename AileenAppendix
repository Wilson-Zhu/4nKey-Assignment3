PART A
 
CREATE TABLE GENRE_T
  (GENREID NUMBER(12,0),
   GENRE_NAME VARCHAR2(20 BYTE),
CONSTRAINT GENRE_T_PK PRIMARY KEY (GENREID));
 
CREATE TABLE WATCHABLE_T
        	(WATCHABLEID NUMBER(12,0) NOT NULL,
        	 WATCHABLE_NAME VARCHAR2(100) NOT NULL,
        	 STORY VARCHAR2(200),
        	 WATCHABLE_TYPE VARCHAR2(6) NOT NULL CHECK(WATCHABLE_TYPE IN ('movie','tvshow')),
CONSTRAINT WATCHBLE_T_PK PRIMARY KEY (WATCHABLEID));
 
CREATE TABLE GENRE_WATCHABLE_T
  (GENREID NUMBER(12,0),
   WATCHABLEID NUMBER(12,0) NOT NULL,
CONSTRAINT GENRE_WATCHABLE_T_PK PRIMARY KEY (WATCHABLEID,GENREID),
CONSTRAINT GENRE_WATCHABLE_T_FK1 FOREIGN KEY (GENREID) REFERENCES GENRE_T(GENREID),
CONSTRAINT GENRE_WATCHABLE_T_FK2 FOREIGN KEY (WATCHABLEID) REFERENCES
WATCHABLE_T(WATCHABLEID));
 
GENRE_T
 
INSERT INTO GENRE_T
VALUES (1,'DRAMA');
 
INSERT INTO GENRE_T
VALUES (2,'CRIME');
 
INSERT INTO GENRE_T
VALUES (3,'ACTION');
 
INSERT INTO GENRE_T
VALUES (4,'COMEDY');
 
INSERT INTO GENRE_T
VALUES (5,'SITCOM');
 
INSERT INTO GENRE_T
VALUES (6,'ROMANCE');
 
INSERT INTO GENRE_T
VALUES (7,'GOOFY');
 
INSERT INTO GENRE_T
VALUES (8,'INSPIRING');
 
INSERT INTO GENRE_T
VALUES (9,'ADVENTURE');
 
INSERT INTO GENRE_T
VALUES (10,'CHILDRENANDFAMILY');
 
INSERT INTO GENRE_T
VALUES (11,'IMAGINATIVE');
 
INSERT INTO GENRE_T
VALUES (12,'SCI-FI');
 
INSERT INTO GENRE_T
VALUES (13,'HORROR');
 
INSERT INTO GENRE_T
VALUES (14,'MYSTERY');
 
INSERT INTO GENRE_T
VALUES (15,'MUSICAL');
 
INSERT INTO GENRE_T
VALUES (16,'WAR');
 
INSERT INTO GENRE_T
VALUES (17,'HISTORY');
 
INSERT INTO GENRE_T
VALUES (18,'BIOGRAPHY');
 
INSERT INTO GENRE_T
VALUES (19,'THRILLER');
 
INSERT INTO GENRE_T
VALUES (20,'SPORT');
 
INSERT INTO GENRE_T
VALUES (21,'WESTERN');
 
WATCHABLE_T
 
INSERT INTO WATCHABLE_T (WATCHABLEID,WATCHABLE_NAME,STORY,WATCHABLE_TYPE)
VALUES (1,'HOW I MET YOUR MOTHER','TED RECOUNTS THE EVENTS THAT LED HIM TO MEETING THEIR MOTHER.','tvshow');
 
INSERT INTO WATCHABLE_T (WATCHABLEID,WATCHABLE_NAME,STORY,WATCHABLE_TYPE)
VALUES (2,'FRIENDS','THE SHOW REVOLVES AROUND SIX 20-30 SOMETHING FRIENDS LIVING IN MANHATTAN.','tvshow');
 
INSERT INTO WATCHABLE_T (WATCHABLEID,WATCHABLE_NAME,STORY,WATCHABLE_TYPE)
VALUES (3,'NARCO','THE TRUE STORY OF COLUMBIAS INFAMOUSLY VIOLENT DRUG CARTELS.','tvshow');
 
INSERT INTO WATCHABLE_T (WATCHABLEID,WATCHABLE_NAME,STORY,WATCHABLE_TYPE)
VALUES (4,'ZOOTOPIA','ZOOTOPIA IS A MAMMAL METROPOLIS WHERE VARIOUS ANIMALS LIVE AND THRIVE.','movie');
 
INSERT INTO WATCHABLE_T (WATCHABLEID,WATCHABLE_NAME,STORY,WATCHABLE_TYPE)
VALUES (5,'FINDING DORY','DORY IS A BLUE TANG FISH WHO SUFFERS FROM MEMORY LOSS EVERY 10 SECONDS OR SO.','movie');
 
INSERT INTO WATCHABLE_T (WATCHABLEID,WATCHABLE_NAME,STORY,WATCHABLE_TYPE)
VALUES (6,'BATMAN V SUPERMAN','CONVINCED THAT SUPERMAN IS NOW A THREAT TO HUMANITY, BATMAN TRIES TO END HIS REIGN...','movie');
 
GENRE_WATCHABLE_T
 
INSERT INTO GENRE_WATCHABLE_T (GENREID,WATCHABLEID)
VALUES (4,1);
 
INSERT INTO GENRE_WATCHABLE_T (GENREID,WATCHABLEID)
VALUES (5,1);
 
INSERT INTO GENRE_WATCHABLE_T (GENREID,WATCHABLEID)
VALUES (6,1);
 
INSERT INTO GENRE_WATCHABLE_T (GENREID,WATCHABLEID)
VALUES (4,2);
 
INSERT INTO GENRE_WATCHABLE_T (GENREID,WATCHABLEID)
VALUES (5,2);
 
INSERT INTO GENRE_WATCHABLE_T (GENREID,WATCHABLEID)
VALUES (6,2);
 
INSERT INTO GENRE_WATCHABLE_T (GENREID,WATCHABLEID)
VALUES (1,3);
 
INSERT INTO GENRE_WATCHABLE_T (GENREID,WATCHABLEID)
VALUES (2,3);
 
INSERT INTO GENRE_WATCHABLE_T (GENREID,WATCHABLEID)
VALUES (7,4);
 
INSERT INTO GENRE_WATCHABLE_T (GENREID,WATCHABLEID)
VALUES (8,4);
 
INSERT INTO GENRE_WATCHABLE_T (GENREID,WATCHABLEID)
VALUES (10,4);
 
INSERT INTO GENRE_WATCHABLE_T (GENREID,WATCHABLEID)
VALUES (11,4);
 
INSERT INTO GENRE_WATCHABLE_T (GENREID,WATCHABLEID)
VALUES (7,5);
 
INSERT INTO GENRE_WATCHABLE_T (GENREID,WATCHABLEID)
VALUES (9,5);
 
INSERT INTO GENRE_WATCHABLE_T (GENREID,WATCHABLEID)
VALUES (10,5);
 
INSERT INTO GENRE_WATCHABLE_T (GENREID,WATCHABLEID)
VALUES (11,5);
 
INSERT INTO GENRE_WATCHABLE_T (GENREID,WATCHABLEID)
VALUES (3,6);
 
INSERT INTO GENRE_WATCHABLE_T (GENREID,WATCHABLEID)
VALUES (12,6);
 
INSERT INTO GENRE_WATCHABLE_T (GENREID,WATCHABLEID)
VALUES (9,6);
 
PART B

B1. 

SELECT GENRE_NAME FROM GENRE_T;
 
B2. 

SELECT GENRE_NAME FROM GENRE_T WHERE GENRE_NAME like 'A%';
 
B3. 

SELECT WATCHABLE_NAME, GENRE_NAME FROM GENRE_T JOIN GENRE_WATCHABLE_T ON GENRE_T.GENREID=GENRE_WATCHABLE_T.GENREID JOIN WATCHABLE_T ON GENRE_WATCHABLE_T.WATCHABLEID=WATCHABLE_T.WATCHABLEID WHERE WATCHABLE_TYPE='movie' ORDER BY WATCHABLE_NAME;
 
B4. 

SELECT COUNT(*) AS CNT FROM WATCHABLE_T WHERE WATCHABLE_TYPE='tvshow';

B5.  

SELECT 'Number of Movies' AS TITLE, COUNT(*) AS CNT FROM WATCHABLE_T WHERE WATCHABLE_TYPE='movie'
UNION 
SELECT 'Number of TV Shows' AS TITLE, COUNT(*) AS CNT FROM WATCHABLE_T WHERE WATCHABLE_TYPE='tvshow'; 

B6. 

SELECT GENRE_NAME FROM GENRE_T JOIN GENRE_WATCHABLE_T ON GENRE_T.GENREID=GENRE_WATCHABLE_T.GENREID JOIN WATCHABLE_T ON GENRE_WATCHABLE_T.WATCHABLEID=WATCHABLE_T.WATCHABLEID WHERE WATCHABLE_NAME='ZOOTOPIA';

B7. 

SELECT GENRE_NAME, COUNT(WATCHABLE_T.WATCHABLEID) AS CNT
FROM GENRE_T LEFT JOIN GENRE_WATCHABLE_T
ON GENRE_T.GENREID=GENRE_WATCHABLE_T.GENREID LEFT JOIN WATCHABLE_T
ON GENRE_WATCHABLE_T.WATCHABLEID=WATCHABLE_T.WATCHABLEID
GROUP BY GENRE_NAME;
 
B8. 

SELECT AVG(COUNT(WATCHABLE_T.WATCHABLEID)) AS AVGCNT
FROM GENRE_T LEFT JOIN GENRE_WATCHABLE_T ON GENRE_T.GENREID=GENRE_WATCHABLE_T.GENREID LEFT JOIN WATCHABLE_T
ON GENRE_WATCHABLE_T.WATCHABLEID=WATCHABLE_T.WATCHABLEID
GROUP BY GENRE_NAME;

B9. 

SELECT WATCHABLE_NAME FROM WATCHABLE_T JOIN GENRE_WATCHABLE_T ON
WATCHABLE_T.WATCHABLEID=GENRE_WATCHABLE_T.WATCHABLEID GROUP BY WATCHABLE_NAME HAVING COUNT(GENRE_WATCHABLE_T.GENREID)>3;
 
B10. 

SELECT GENREID FROM GENRE_WATCHABLE_T WHERE GENRE_WATCHABLE_T.WATCHABLEID=4 MINUS SELECT GENREID FROM GENRE_WATCHABLE_T WHERE GENRE_WATCHABLE_T.WATCHABLEID=5;
