/* A1 */

SET DEFINE OFF;

INSERT ALL
    INTO Genre_T (GENRE_NAME)
        VALUES ('Drama')
    INTO Genre_T (GENRE_NAME)
        VALUES ('Crime')
    INTO Genre_T (GENRE_NAME)
        VALUES ('Action')
    INTO Genre_T (GENRE_NAME)
        VALUES ('Comedy')
    INTO Genre_T (GENRE_NAME)
        VALUES ('Sitcom')
    INTO Genre_T (GENRE_NAME)
        VALUES ('Romance')
    INTO Genre_T (GENRE_NAME)
        VALUES ('Goofy')
    INTO Genre_T (GENRE_NAME)
        VALUES ('Inspiring')
    INTO Genre_T (GENRE_NAME)
        VALUES ('Adventure')
    INTO Genre_T (GENRE_NAME)
        VALUES ('Children and Family')
    INTO Genre_T (GENRE_NAME)
        VALUES ('Imaginative')
    INTO Genre_T (GENRE_NAME)
        VALUES ('SciFi')
    INTO Genre_T (GENRE_NAME)
        VALUES ('Horror')
    INTO Genre_T (GENRE_NAME)
        VALUES ('Mystery')
    INTO Genre_T (GENRE_NAME)
        VALUES ('Musical')
    INTO Genre_T (GENRE_NAME)
        VALUES ('War')
    INTO Genre_T (GENRE_NAME)
        VALUES ('History')
    INTO Genre_T (GENRE_NAME)
        VALUES ('Biography')
    INTO Genre_T (GENRE_NAME)
        VALUES ('Thriller')
    INTO Genre_T (GENRE_NAME)
        VALUES ('Sport')
    INTO Genre_T (GENRE_NAME)
        VALUES ('Western')
SELECT * FROM dual;

/* A2 */

INSERT ALL
    INTO GENRE_WATCHABLE_T GENREID,WATCHABLEID) VALUES (4,1)
    INTO GENRE_WATCHABLE_T GENREID,WATCHABLEID) VALUES (5,1)
    INTO GENRE_WATCHABLE_T GENREID,WATCHABLEID) VALUES (6,1)
    INTO GENRE_WATCHABLE_T GENREID,WATCHABLEID) VALUES (4,2)
    INTO GENRE_WATCHABLE_T GENREID,WATCHABLEID) VALUES (5,2)
    INTO GENRE_WATCHABLE_T GENREID,WATCHABLEID) VALUES (6,2)
    INTO GENRE_WATCHABLE_T GENREID,WATCHABLEID) VALUES (1,3)
    INTO GENRE_WATCHABLE_T GENREID,WATCHABLEID) VALUES (1,3)
    INTO GENRE_WATCHABLE_T GENREID,WATCHABLEID) VALUES (7,4)
    INTO GENRE_WATCHABLE_T GENREID,WATCHABLEID) VALUES (8,4)
    INTO GENRE_WATCHABLE_T GENREID,WATCHABLEID) VALUES (10,4)
    INTO GENRE_WATCHABLE_T GENREID,WATCHABLEID) VALUES (11,4)
    INTO GENRE_WATCHABLE_T GENREID,WATCHABLEID) VALUES (7,5)
    INTO GENRE_WATCHABLE_T GENREID,WATCHABLEID) VALUES (9,5)
    INTO GENRE_WATCHABLE_T GENREID,WATCHABLEID) VALUES (10,5)
    INTO GENRE_WATCHABLE_T GENREID,WATCHABLEID) VALUES (11,5)
    INTO GENRE_WATCHABLE_T GENREID,WATCHABLEID) VALUES (3,6)
    INTO GENRE_WATCHABLE_T GENREID,WATCHABLEID) VALUES (12,6)
    INTO GENRE_WATCHABLE_T GENREID,WATCHABLEID) VALUES (9,6)
SELECT * FROM dual;

/* A3 */

INSERT ALL
   INTO GENRE_T (Name, Story, Watchable_Type) VALUES ('How I Met Your Mother', 'Ted recounts the events that led him to meeting their mother.', 'tvshow')
   INTO GENRE_T (Name, Story, Watchable_Type) VALUES ('Friends', 'The show revolves around six 20-30 something friends living in Manhatten.', 'tvshow')
   INTO GENRE_T (Name, Story, Watchable_Type) VALUES ('Narcos', 'The true story of Columbias infamously violent drug cartels.', 'tvshow')
   INTO GENRE_T (Name, Story, Watchable_Type) VALUES ('Zootopia', 'Zootopia is a mammal metropolis where various animals live and thrive.', 'movie')
   INTO GENRE_T (Name, Story, Watchable_Type) VALUES ('Finding Dory', 'Dory is a blue tang fish who sufferse from memory loss every 10 seconds or so.', 'movie')
   INTO GENRE_T (Name, Story, Watchable_Type) VALUES ('Batman v Superman', 'Convinced that Superman is now a threat to humanity, Batman tries to end his reign...', 'movie')
SELECT * FROM dual;

/* B1 */

SELECT GENRE_NAME FROM GENRE_T
;

/* B2 */

SELECT GENRE_NAME FROM GENRE_T WHERE GENRE_NAME LIKE 'A%'
;

/* B3 */

SELECT WATCHABLE_NAME, GENRE_NAME
FROM GENRE_T
    JOIN GENRE_WATCHABLE_T ON GENRE_T.GENREID=GENRE_WATCHABLE_T.GENREID
    JOIN WATCHABLE_T ON GENRE_WATCHABLE_T.WATCHABLEID=WATCHABLE_T.WATCHABLEID
        WHERE WATCHABLE_TYPE='movie'
        ORDER BY WATCHABLE_NAME
;

/* B4 */

SELECT COUNT(*) AS CNT FROM WATCHABLE_T
WHERE WATCHABLETYPE ='tvshow'
;

/* B5 */

SELECT COUNT(*) AS CNT FROM WATCHABLE_T
;

/* B6 */

SELECT GENRE_NAME
FROM GENRE_T
    JOIN GENRE_WATCHABLE_T ON GENRE_T.GENREID=GENRE_WATCHABLE_T.GENREID
    JOIN WATCHABLE_T ON GENRE_WATCHABLE_T.WATCHABLEID=WATCHABLE_T.WATCHABLEID
WHERE WATCHABLE_NAME='Zootopia'
;

/* B7 */

SELECT GENRENAME, COUNT(*) AS CNT
FROM GENRE_T JOIN GENRE_WATCHABLE_T
ON GENRE_T.GENREID=GENRE_WATCHABLE_T.GENREID JOIN WATCHABLE_T
ON GENRE_WATCHABLE_T.WATCHABLEID=WATCHABLE_T.WATCHABLEID
GROUP BY GENRENAME
;

/* B8 */

SELECT AVG(COUNT(WATCHABLE_T.WATCHABLEID)) AS AVERAGE
FROM GENRE_T
    LEFT JOIN GENRE_WATCHABLE_T ON GENRE_T.GENREID=GENRE_WATCHABLE_T.GENREID 
    LEFT JOIN WATCHABLE_T ON GENRE_WATCHABLE_T.WATCHABLEID=WATCHABLE_T.WATCHABLEID
GROUP BY GENRE_NAME
;

/* B9 */

SELECT WATCHABLE_NAME, COUNT(WATCHABLE_T.WATCHABLEID) AS CNT
FROM WATCHABLE_T 
    JOIN GENRE_WATCHABLE_T ON WATCHABLE_T.WATCHABLEID=GENRE_WATCHABLE_T.WATCHABLEID 
    JOIN GENRE_T ON GENRE_WATCHABLE_T.GENREID=GENRE_T.GENREID 
GROUP BY WATCHABLE_NAME
HAVING COUNT (WATCHABLE_T.WATCHABLEID)>3
;

/* B10 */

SELECT GENREID
FROM GENRE_WATCHABLE_T
WHERE GENRE_WATCHABLE_T.WATCHABLEID=4 IN    (SELECT GENREID
                                            FROM GENRE_WATCHABLE_T
                                            WHERE GENRE_WATCHABLE_T.WATCHABLEID!=5)
;
